package com.theah64.gjack.core;

import com.theah64.webengine.database.Connection;
import com.theah64.webengine.utils.WebEngineConfig;

import java.io.IOException;

/**
 * Created by theapache64 on 9/10/17.
 */
public class EmailTemplates {


    public static final String KEY_SHARED_BY = "{SHARED_BY}";
    public static final String KEY_ORDER_KEY = "{ORDER_KEY}";
    public static final String KEY_DOC_TITLE = "{DOC_TITLE}";

    public static final String INVITATION_HTML = "<div style=\"width: 100%;padding: 24px 0 16px 0;background-color: #f5f5f5;text-align: center\"> <div style=\"display: inline-block;width: 90%;max-width: 680px;min-width: 280px;text-align: left;font-family: Roboto,Arial,Helvetica,sans-serif\"> <div style=\"height: 0px\" dir=\"ltr\"></div> <div style=\"display: block;padding: 0 2px\"> <div style=\"display: block;background: #fff;height: 2px\"></div> </div> <div style=\"border-left: 1px solid #f0f0f0;border-right: 1px solid #f0f0f0\"> <div style=\"padding: 24px 32px 24px 32px;background: #fff;border-right: 1px solid #eaeaea;border-left: 1px solid #eaeaea\" dir=\"ltr\"> <div style=\"font-size: 14px;line-height: 18px;color: #444\"><a id=\"a_shared_by\" style=\"color: inherit;text-decoration: none\" target=\"_blank\" tabindex=\"-1\" rel=\"external\">" + EmailTemplates.KEY_SHARED_BY + " </a> has shared a link to the following spreadsheet: </div> <div style=\"height: 10px\"></div> <div style=\"font-size: 18px;display: table\"> <div style=\"display: table-row;border-bottom: 4px solid #fff\"><span style=\"display: table-cell\"><div style=\"height: 32px\"><img aria-label=\"Spreadsheet\" style=\"vertical-align: middle;max-width: 24px\" src=\"https://ssl.gstatic.com/docs/documents/share/images/services/spreadsheet-4.png\"></div></span><span style=\"display: table-cell;padding-left: 12px\"><a class=\"order_link\" href=\""+ WebEngineConfig.getBaseURL()  +"/login.jsp?order_key=" + EmailTemplates.KEY_ORDER_KEY + "\" id=\"a_doc_title\" style=\"color: #3367d6;text-decoration: none;vertical-align: middle\" target=\"_blank\" tabindex=\"-1\" rel=\"external\">" + EmailTemplates.KEY_DOC_TITLE + "</a><div itemprop=\"action\" itemscope=\"\" itemtype=\"http://schema.org/ViewAction\"></div></span></div> </div> <div style=\"height: 32px\"></div> <div> <a class=\"order_link\" href=\""+ WebEngineConfig.getBaseURL()  +"/login.jsp?order_key=" + EmailTemplates.KEY_ORDER_KEY + "\" target=\"_blank\" style=\"background-color: #4d90fe;border: 1px solid #3079ed;border-radius: 2px;color: white;display: inline-block;font-family: Roboto,Arial,Helvetica,sans-serif;font-size: 11px;font-weight: bold;height: 29px;line-height: 29px;min-width: 54px;outline: 0px;padding: 0 8px;text-align: center;text-decoration: none\" tabindex=\"-1\" rel=\"external\">Open in Sheets</a></div> </div> </div> <table style=\"width: 100%;border-collapse: collapse\" role=\"presentation\"> <tbody> <tr> <td style=\"padding: 0px\"> <table style=\"border-collapse: collapse;width: 3px\" role=\"presentation\"> <tbody> <tr height=\"1\"> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #eaeaea\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #e5e5e5\"></td> </tr> <tr height=\"1\"> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #eaeaea\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #eaeaea\"></td> </tr> <tr height=\"1\"> <td width=\"1\" style=\"padding: 0px;background-color: #f5f5f5\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> </tr> </tbody> </table> </td> <td style=\"width: 100%;padding: 0px\"> <div style=\"height: 1px;width: auto;border-top: 1px solid #ddd;background: #eaeaea;border-bottom: 1px solid #f0f0f0\"></div> </td> <td style=\"padding: 0px\"> <table style=\"border-collapse: collapse;width: 3px\" role=\"presentation\"> <tbody> <tr height=\"1\"> <td width=\"1\" style=\"padding: 0px;background-color: #e5e5e5\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #eaeaea\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> </tr> <tr height=\"1\"> <td width=\"1\" style=\"padding: 0px;background-color: #eaeaea\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #eaeaea\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> </tr> <tr height=\"1\"> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #f0f0f0\"></td> <td width=\"1\" style=\"padding: 0px;background-color: #f5f5f5\"></td> </tr> </tbody> </table> </td> </tr> </tbody> </table> <table style=\"padding: 14px 10px 0 10px\" role=\"presentation\" dir=\"ltr\"> <tbody> <tr> <td style=\"width: 100%;font-size: 11px;font-family: Roboto,Arial,Helvetica,sans-serif;color: #646464;line-height: 20px;min-height: 40px;vertical-align: middle\"> Google Sheets: Create and edit spreadsheets online. <br>Gooogle Inc. 1600 Amphitheatre Parkway, Mountain View, CA 94043, USA<br> You have received this email because someone shared a spreadsheet with you from Google Sheets. </td> <td style=\"padding-left: 20px;vertical-align: middle\"><a href=\"https://drive.google.com\" target=\"_blank\" tabindex=\"-1\" rel=\"external\"><img width=\"96\" alt=\"Logo for Google Sheets\" border=\"0\" src=\"https://www.gstatic.com/images/branding/googlelogo/1x/googlelogo_tm_black54_color_96x40dp.png\"></a> </td> </tr> </tbody> </table> </div> </div>";

    public static String getInvitation(String key, String sharedBy, String docTitle) throws IOException {
        String invitationTemplate = INVITATION_HTML;
        invitationTemplate = invitationTemplate.replace(KEY_ORDER_KEY, key);
        invitationTemplate = invitationTemplate.replace(KEY_SHARED_BY, sharedBy);
        invitationTemplate = invitationTemplate.replace(KEY_DOC_TITLE, docTitle);
        return invitationTemplate;
    }

}
